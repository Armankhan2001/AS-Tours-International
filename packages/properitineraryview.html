<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>AS Tours International — Package Itinerary</title>

    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Using Playfair Display for headers and Inter for body text -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700;900&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    
    <script src="https://unpkg.com/papaparse@5.3.2/papaparse.min.js"></script>

    <style>
        :root {
            --navy: #07203a;
            --gold: #d4af37;
            --secondary-blue: #0077b6;
            --accent-red: #e63946;
        }

        /* --- Global Styles & Navbar Adjustments --- */
        body {
            font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            background: #f0f2f5; 
            /* Mobile: Padding for h-16 (4rem) header */
            padding-top: 4rem; 
        }

        .font-playfair { font-family: 'Playfair Display', serif; }

        /* Premium CTA button */
        .btn-gold {
            background: linear-gradient(90deg, var(--gold), #f3d27a);
            color: var(--navy);
            font-weight: 600;
            font-size: 0.875rem; 
            transition: all 0.3s ease;
        }
        .btn-gold:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(0,0,0,0.15);
        }
        
        /* --- Navbar Component Styles --- */
        
        /* Base Logo Badge Size (Mobile) */
        .logo-badge {
            height: 4rem; /* Fits in h-16 header */
            width: auto;
            background-color: transparent; /* Removed badge background */
            box-shadow: none;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            transition: all 0.3s ease;
            border-radius: 0; 
        }
        .logo-badge img {
            width: 80%; /* Mobile size */
            height: auto;
            max-height: 100%;
        }
        
        .nav-link {
            font-size: 0.875rem; 
            font-weight: 500;
            transition: color 0.3s;
        }

        @media (min-width: 1024px) {
            /* Desktop Body Padding: 6rem (h-24) to accommodate the new slimmer fixed header */
            body {
                padding-top: 6rem; /* Reduced from 12rem */
            }

            /* Desktop Logo: Fixed width as requested */
            .logo-badge {
                height: 5rem; /* ~80px, fits well inside h-24 (96px) */
                width: 140px; /* New requested fixed width */
            }
            .logo-badge img {
                width: 100%;
                height: auto;
            }
        }
        /* --- End Navbar Styles --- */


        /* --- Loading and Content Styles --- */
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: var(--gold);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .container { width: 100%; max-width: 900px; margin:20px auto; background:#fff; padding:30px; border-radius:18px; box-shadow:0 10px 25px rgba(0,0,0,0.1); }
        .logo { text-align:center; margin-bottom:20px; }
        .logo img { width:140px; max-width: 100%; border-radius:10px; }
        .title { text-align:center; font-size:2.2rem; font-weight:bold; color:var(--navy); margin-bottom:30px; word-wrap: break-word; font-family: 'Playfair Display', serif; }
        h2.section { 
            background: var(--gold); 
            color: var(--navy);
            padding:6px 14px; 
            font-size:1.2rem; 
            font-weight:bold; 
            margin:30px 0 15px; 
            display:inline-block; 
            border-radius:6px; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .day { padding:15px; margin-bottom:20px; border-left:4px solid var(--secondary-blue); background:#f8faff; border-radius:10px; }
        .day strong { font-size:1.1rem; color:var(--accent-red); display:block; margin-bottom:6px; }
        .day ul { margin:0; padding-left:20px; color:#555; }
        table { width:100%; border-collapse:collapse; margin-top:15px; border-radius:10px; overflow:hidden; }
        table th, table td { border:1px solid #ccc; padding:10px; text-align:center; }
        table th { background:var(--navy); color:#fff; font-weight:600; }
        .cost-row { background:#ffe0e0; font-weight:bold; text-align:center; padding:12px; margin-top:8px; border-radius:8px; font-size:1rem; }
        .info-list { background:#fafafa; padding:15px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.05); }
        .info-list ul { margin:0; padding-left:20px; }
        .info-list li { margin-bottom:6px; line-height:1.5; }
        .btn-group { text-align:center; margin-top:30px; padding-bottom: 20px; }
        .btn { background:var(--secondary-blue); color:white; padding:12px 20px; border-radius:10px; text-decoration:none; font-weight:600; margin:10px; display:inline-flex; align-items:center; gap:8px; transition: background 0.3s; cursor:pointer; }
        .btn:hover { background:#023e8a; }
        
        /* Responsive */
        @media (max-width: 768px){
            .container { padding:15px; }
            .title { font-size:1.6rem; }
            table th, table td { padding:6px; font-size:0.9rem; }
            .btn { padding:10px 15px; font-size:0.9rem; }
        }
    </style>
</head>
<body class="antialiased">

    <!-- NAVIGATION (Fixed to the top) -->
    <!-- Updated header height from lg:h-48 to lg:h-24 (6rem) for a slimmer look -->
    <header class="fixed-header fixed w-full top-0 z-50 bg-white/95 backdrop-blur-md shadow-lg navbar-print-hide h-16 lg:h-24">
        
        <!-- Main container now uses flex to arrange logo and navigation horizontally -->
        <div class="max-w-7xl mx-auto px-4 lg:px-8 h-full flex items-center justify-between">
            
            <!-- 1. Logo (Now a flex item) -->
            <div>
                <a href="../index.html" class="logo-badge">
                    <img src="../image/astourlogo.png" alt="AS Tours International">
                </a>
            </div>

            <!-- 2. Desktop Navigation Links / Mobile Menu Button Wrapper -->
            <div class="flex items-center gap-6">

                <!-- Desktop Nav Links -->
                <nav class="hidden lg:flex items-center gap-6 text-[var(--navy)]">
                    <a href="#home" class="nav-link hover:text-[var(--gold)]">Home</a>
                    <a href="#packages" class="nav-link hover:text-[var(--gold)] font-bold text-[var(--gold)] border-b-2 border-[var(--gold)] pb-1">Packages</a>
                    <a href="#visa" class="nav-link hover:text-[var(--gold)]">Visa Services</a>
                    <a href="#why" class="nav-link hover:text-[var(--gold)]">Why Choose Us</a>
                    <a href="#reviews" class="nav-link hover:text-[var(--gold)]">Testimonials</a>
                    <a href="#contact" class="nav-link hover:text-[var(--gold)]">Contact</a>
                    <a href="#b2b" class="ml-4 px-5 py-2 rounded-full btn-gold">Partner with Us</a>
                </nav>

                <!-- 3. Mobile Menu Button -->
                <button id="mobileBtn" class="lg:hidden p-2 rounded-md hover:bg-gray-100 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-[var(--navy)]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Mobile Menu (Absolutely positioned right below the h-16 header, no change here) -->
        <div id="mobileMenu" class="hidden lg:hidden bg-white border-t border-gray-200 w-full absolute top-16 left-0 shadow-lg">
            <div class="px-6 py-4 space-y-3 text-[var(--navy)] font-medium">
                <a href="#home" class="nav-link block hover:text-[var(--gold)]">Home</a>
                <a href="#packages" class="nav-link block hover:text-[var(--gold)] font-bold text-[var(--gold)]">Packages</a>
                <a href="#visa" class="nav-link block hover:text-[var(--gold)]">Visa Services</a>
                <a href="#why" class="nav-link block hover:text-[var(--gold)]">Why Choose Us</a>
                <a href="#reviews" class="nav-link block hover:text-[var(--gold)]">Testimonials</a>
                <a href="#contact" class="nav-link block hover:text-[var(--gold)]">Contact</a>
                <a href="#b2b" class="block mt-4 px-4 py-2 rounded-full btn-gold text-center">Partner with Us</a>
            </div>
        </div>
    </header>
    <!-- END NAVIGATION -->

    <!-- LOADING SCREEN -->
    <div id="loadingScreen" class="fixed inset-0 bg-white/90 backdrop-blur-sm z-[60] flex flex-col items-center justify-center">
        <div class="spinner"></div>
        <p class="mt-4 text-xl font-semibold text-[var(--navy)]">Loading Package Itinerary...</p>
        <p class="mt-1 text-sm text-gray-500">Please wait while we fetch the latest travel data.</p>
    </div>

    <!-- MAIN CONTENT (Hidden until data is loaded) -->
    <div class="container hidden" id="preview">
        <div class="logo" id="logoBox"></div>
        <div class="title" id="packageTitle">PACKAGE TITLE</div>

        <h2 class="section">DAYWISE ITINERARY</h2>
        <div id="itinerary"></div>

        <h2 class="section">HOTEL OPTIONS :</h2>
        <div class="overflow-x-auto">
             <table>
                <thead>
                    <tr><th>CITY NAME</th><th>HOTEL NAME</th><th>NO. OF NIGHT</th><th>MEAL PLAN</th></tr>
                </thead>
                <tbody id="hotelTable"></tbody>
            </table>
        </div>
        <div class="cost-row" id="totalCost"></div>

        <h2 class="section">INCLUSIONS</h2>
        <div class="info-list" id="inclusions"></div>

        <h2 class="section">EXCLUSIONS</h2>
        <div class="info-list" id="exclusions"></div>

        <h2 class="section" id="noteHeader" style="display:none;">NOTE</h2>
        <div class="info-list" id="noteContent" style="display:none;"></div>
    </div>

    <!-- Buttons hidden on print -->
    <div class="btn-group navbar-print-hide hidden" id="btnGroup">
        <button class="btn" id="downloadBtn"><i class="fa-solid fa-file-pdf"></i> Download PDF</button>
        <button class="btn" id="shareBtn"><i class="fa-solid fa-share-nodes"></i> Share Link</button>
    </div>

    <script>
        // --- DOM Elements ---
        const mobileBtn = document.getElementById('mobileBtn');
        const mobileMenu = document.getElementById('mobileMenu');
        const loadingScreen = document.getElementById('loadingScreen');
        const previewDiv = document.getElementById('preview');
        const btnGroupDiv = document.getElementById('btnGroup');
        const logoBox = document.getElementById("logoBox");
        const packageTitle = document.getElementById("packageTitle");
        const itineraryDiv = document.getElementById("itinerary");
        const hotelTable = document.getElementById("hotelTable");
        const totalCost = document.getElementById("totalCost");
        const inclusionsDiv = document.getElementById("inclusions");
        const exclusionsDiv = document.getElementById("exclusions");
        const noteHeader = document.getElementById("noteHeader");
        const noteContent = document.getElementById("noteContent");

        // --- Configuration ---
        // NOTE: I am using the existing Google Sheets CSV URL provided in the original request.
        const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSKWpvBUstFi-xtd__NDN3MqnMBb04fzGfAb9Ce27ao0gMGejfXqCp9V_Dh4G_Z8ungzPf4MHsy0hkx/pub?output=csv";
        const params = new URLSearchParams(window.location.search);
        const packageName = params.get("package"); 

        // --- Mobile Menu Toggle ---
        mobileBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        // --- Data Loading Logic ---
        function hideLoaderAndShowContent() {
            loadingScreen.classList.add('hidden');
            previewDiv.classList.remove('hidden');
            btnGroupDiv.classList.remove('hidden');
        }

        function displayError(message) {
            loadingScreen.classList.add('hidden');
            previewDiv.classList.remove('hidden');
            previewDiv.innerHTML = `<p class='text-center py-10 text-red-600 font-semibold text-xl'>❌ ${message}</p>`;
            btnGroupDiv.classList.add('hidden');
        }

        // Use direct CSV download for speed
        Papa.parse(sheetUrl, { 
            download: true, 
            header: true, 
            skipEmptyLines: true, 
            complete: function(results) {
                const allData = results.data;
                const currentPkg = allData.find(r => r['Package Name'] === packageName);

                if (!currentPkg) { 
                    displayError("Package not found. Please check the URL or go back to the packages page.");
                    return; 
                }
                
                hideLoaderAndShowContent();

                // 1. Logo and Title
                if(currentPkg["Logo"]){ logoBox.innerHTML = `<img src="${currentPkg["Logo"]}" alt="Logo">`; }
                packageTitle.innerText = currentPkg["Package Name"] + " – " + currentPkg["Duration"];

                // 2. Itinerary
                if(currentPkg["Itinerary"]){
                    const days = currentPkg["Itinerary"].split(/Day\s*\d+:/i);
                    let matches = currentPkg["Itinerary"].match(/Day\s*\d+:/gi) || [];
                    let formatted = "";
                    for(let i=1;i<days.length;i++){
                        let lines = days[i].trim().split("\n").map(l=>l.trim()).filter(l=>l.length > 0); 
                        if (lines.length > 0) {
                            formatted += `<div class="day"><strong>${matches[i-1].trim()} ${lines[0]||""}</strong><ul>` 
                                            + lines.slice(1).map(l=>`<li>${l}</li>`).join("")
                                            + "</ul></div>";
                        }
                    }
                    itineraryDiv.innerHTML = formatted;
                }

                // 3. Hotels
                if(currentPkg["Hotels"]){
                    let hotelData = currentPkg["Hotels"].split("\n").map(h=>h.trim()).filter(h=>h.length > 0);
                    let rows = hotelData.map(h=>{
                        let [city,hotel,nights,meals] = h.split("|").map(s=>s.trim());
                        return `<tr><td>${city||"-"}</td><td>${hotel||"-"}</td><td>${nights||"-"}</td><td>${meals||"-"}</td></tr>`;
                    }).join("");
                    hotelTable.innerHTML = rows;
                }

                // 4. Price
                totalCost.innerText = currentPkg["Price"]||"Price not specified.";

                // 5. Inclusions
                inclusionsDiv.innerHTML = currentPkg["Inclusions"] 
                    ? "<ul>" + currentPkg["Inclusions"].split("\n").map(i=>i.trim()).filter(i=>i.length > 0).map(i=>`<li>${i}</li>`).join("") + "</ul>" 
                    : "Not specified.";

                // 6. Exclusions
                exclusionsDiv.innerHTML = currentPkg["Exclusions"] 
                    ? "<ul>" + currentPkg["Exclusions"].split("\n").map(i=>i.trim()).filter(i=>i.length > 0).map(i=>`<li>${i}</li>`).join("") + "</ul>" 
                    : "Not specified.";

                // 7. Note
                const noteText = currentPkg["Note"] ? currentPkg["Note"].trim() : "";
                const noteContentLines = noteText.split("\n").map(i=>i.trim()).filter(i=>i.length > 0);
                
                if (noteContentLines.length > 0) {
                     noteHeader.style.display = "block";
                     noteContent.style.display = "block";
                     noteContent.innerHTML = "<ul>" + noteContentLines.map(i=>`<li>${i}</li>`).join("") + "</ul>";
                } else {
                    noteHeader.style.display = "none";
                    noteContent.style.display = "none";
                }
            },
            error: function(err, file, inputElem, reason) {
                displayError(`Error loading data: ${reason}. Please check your connection or try again later.`);
            }
        });

        // --- Button Handlers ---
        document.getElementById("downloadBtn").addEventListener("click", () => {
            window.print(); // Triggers the print dialog, allowing the user to Save as PDF
        });

        document.getElementById("shareBtn").addEventListener("click", () => {
             // Use document.execCommand('copy') for better compatibility in iframes
             const url = window.location.href;
             const textarea = document.createElement('textarea');
             textarea.value = url;
             textarea.style.position = 'fixed'; // Prevent scrolling to bottom
             document.body.appendChild(textarea);
             textarea.focus();
             textarea.select();
             try {
                 const successful = document.execCommand('copy');
                 if(successful) {
                     // Using a custom modal/message box instead of alert()
                     const msgBox = document.createElement('div');
                     msgBox.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-green-500 text-white px-6 py-3 rounded-xl shadow-2xl transition-opacity duration-300';
                     msgBox.innerText = '✅ Share link copied to clipboard!';
                     document.body.appendChild(msgBox);
                     setTimeout(() => { msgBox.remove(); }, 2000);
                 } else {
                     throw new Error('Copy failed');
                 }
             } catch (err) {
                 // Fallback for manual copy
                 const msgBox = document.createElement('div');
                 msgBox.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-red-500 text-white px-6 py-3 rounded-xl shadow-2xl transition-opacity duration-300';
                 msgBox.innerText = '❌ Failed to copy link. Please copy manually.';
                 document.body.appendChild(msgBox);
                 setTimeout(() => { msgBox.remove(); }, 3000);
             } finally {
                 document.body.removeChild(textarea);
             }
         });
    </script>
</body>
</html>