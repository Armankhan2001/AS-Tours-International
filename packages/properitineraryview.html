<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Itinerary View</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700;900&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://unpkg.com/papaparse@5.3.2/papaparse.min.js"></script>

    <style>
        :root {
            --navy: #07203a;
            --gold: #d4af37;
            --secondary-blue: #0077b6;
            --accent-red: #e63946;
        }

        /* --- Navbar Component Styles (Restored to match your request) --- */
        .btn-gold {
            background: linear-gradient(90deg, var(--gold), #f3d27a);
            color: var(--navy);
            font-weight: 600;
            font-size: 0.875rem;
            transition: all 0.3s ease;
        }
        .btn-gold:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(0,0,0,0.15);
        }
        .logo-badge {
            height: 140px; /* Base height for logo */
            width: 140px;
            background-color: #ffd700;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            /* Ensure the logo image is correctly sourced, adjust path if needed */
        }
        .logo-badge img {
            width: 90%;
            height: auto;
            padding: 4px;
        }
        @media (min-width: 1024px) {
            .logo-badge {
                height: 160px; /* Desktop height */
                width: 160px;
            }
        }
        .nav-link {
            font-size: 0.875rem; 
            font-weight: 500;
            transition: color 0.3s;
        }
        /* --- End Navbar Styles --- */

        /* Original Itinerary Styles */
        body { 
            font-family: 'Inter', sans-serif; 
            background: #f0f2f5; 
            margin:0; 
            /* FIX: Set body padding to match the fixed navbar height (h-16 = 64px) */
            padding-top: 64px; 
            color:#333; 
        }
        
        /* Adjust padding for the large logo on desktop to prevent visual overlap */
        @media (min-width: 1024px) {
             body {
                padding-top: 64px; /* Matches h-16 height */
             }
        }
        
        .font-playfair { font-family: 'Playfair Display', serif; }
        .container { width: 100%; max-width: 900px; margin:auto; background:#fff; padding:30px; border-radius:18px; box-shadow:0 10px 25px rgba(0,0,0,0.1); }
        .logo { text-align:center; margin-bottom:20px; }
        .logo img { width:140px; max-width: 100%; border-radius:10px; }
        .title { text-align:center; font-size:2.2rem; font-weight:bold; color:var(--navy); margin-bottom:30px; word-wrap: break-word; font-family: 'Playfair Display', serif; }
        h2.section { 
            background: var(--gold); 
            color: var(--navy);
            padding:6px 14px; 
            font-size:1.2rem; 
            font-weight:bold; 
            margin:30px 0 15px; 
            display:inline-block; 
            border-radius:6px; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .day { padding:15px; margin-bottom:20px; border-left:4px solid var(--secondary-blue); background:#f8faff; border-radius:10px; page-break-inside: avoid; }
        .day strong { font-size:1.1rem; color:var(--accent-red); display:block; margin-bottom:6px; }
        .day ul { margin:0; padding-left:20px; color:#555; }
        table { width:100%; border-collapse:collapse; margin-top:15px; border-radius:10px; overflow:hidden; page-break-inside: avoid; }
        table th, table td { border:1px solid #ccc; padding:10px; text-align:center; }
        table th { background:var(--navy); color:#fff; font-weight:600; }
        .cost-row { background:#ffe0e0; font-weight:bold; text-align:center; padding:12px; margin-top:8px; border-radius:8px; font-size:1rem; page-break-inside: avoid; }
        .info-list { background:#fafafa; padding:15px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.05); page-break-inside: avoid; }
        .info-list ul { margin:0; padding-left:20px; }
        .info-list li { margin-bottom:6px; line-height:1.5; }
        .btn-group { text-align:center; margin-top:30px; }
        .btn { background:var(--secondary-blue); color:white; padding:12px 20px; border-radius:10px; text-decoration:none; font-weight:600; margin:10px; display:inline-flex; align-items:center; gap:8px; transition: background 0.3s; cursor:pointer; }
        .btn:hover { background:#023e8a; }

        /* Responsive */
        @media (max-width: 768px){
            .container { padding:15px; }
            .title { font-size:1.6rem; }
            table th, table td { padding:6px; font-size:0.9rem; }
            .btn { padding:10px 15px; font-size:0.9rem; }
        }

        /* Print styles */
        @media print {
            body { background: white; padding:0 !important; }
            .navbar-print-hide { display: none !important; } /* Hide Navbar when printing */
            .container { box-shadow: none; border-radius: 0; padding:0; margin:0; }
            .btn-group { display: none; }
            h2.section { page-break-after: avoid; }
            .day, table, .cost-row, .info-list { page-break-inside: avoid; }
        }
    </style>
</head>
<body>

    <header class="relative top-0 z-50 bg-white/95 backdrop-blur-md shadow-sm navbar-print-hide fixed w-full">
        <div class="max-w-7xl mx-auto px-4 lg:px-8">
            <div class="flex items-center justify-between h-16">

                <div class="absolute top-0 left-4 z-50">
                    <a href="../templates/astours.html" class="logo-badge">
                        <img src="../image/astourlogo.png" alt="AS Tours International">
                    </a>
                </div>

                <div class="w-36 flex-shrink-0"></div>

                <nav class="hidden lg:flex items-center gap-6 text-[var(--navy)]">
                    <a href="../templates/astours.html" class="nav-link hover:text-[var(--gold)]">Home</a>
                    <a href="../packages/packages.html" class="nav-link hover:text-[var(--gold)] font-bold text-[var(--gold)] border-b-2 border-[var(--gold)]">Packages</a>
                    <a href="../visa/visaservices.html" class="nav-link hover:text-[var(--gold)]">Visa Services</a>
                    <a href="../templates/Travel/About.html" class="nav-link hover:text-[var(--gold)]">About</a>
                    <a href="../templates/contact.html" class="nav-link hover:text-[var(--gold)]">Contact</a>
                    <a href="../b2b/Visa/b2b.html" class="ml-4 px-5 py-2 rounded-full btn-gold">Partner with Us</a>
                </nav>

                <div class="lg:hidden ml-auto">
                    <button id="mobileBtn" class="p-2 rounded-md hover:bg-gray-100 transition-colors">
                        <i class="fas fa-bars fa-lg text-[var(--navy)]"></i>
                    </button>
                </div>

            </div>
        </div>

        <div id="mobileMenu" class="hidden lg:hidden bg-white border-t border-gray-200 w-full">
            <div class="px-6 py-4 space-y-3 text-[var(--navy)] font-medium">
                <div class="h-10"></div> 
                <a href="../templates/astours.html" class="nav-link block hover:text-[var(--gold)]">Home</a>
                <a href="../packages/packages.html" class="nav-link block hover:text-[var(--gold)] font-bold text-[var(--gold)]">Packages</a>
                <a href="../visa/visaservices.html" class="nav-link block hover:text-[var(--gold)]">Visa Services</a>
                <a href="../templates/Travel/About.html" class="nav-link block hover:text-[var(--gold)]">About</a>
                <a href="../templates/contact.html" class="nav-link block hover:text-[var(--gold)]">Contact</a>
                <a href="../b2b/Visa/b2b.html" class="block mt-2 px-4 py-2 rounded-full btn-gold text-center">Partner with Us</a>
            </div>
        </div>
    </header>
    <div class="container" id="preview">
        <div class="logo" id="logoBox"></div>
        <div class="title" id="packageTitle">PACKAGE TITLE</div>

        <h2 class="section">DAYWISE ITINERARY</h2>
        <div id="itinerary"></div>

        <h2 class="section">HOTEL OPTIONS :</h2>
        <table>
            <thead>
                <tr><th>CITY NAME</th><th>HOTEL NAME</th><th>NO. OF NIGHT</th><th>MEAL PLAN</th></tr>
            </thead>
            <tbody id="hotelTable"></tbody>
        </table>
        <div class="cost-row" id="totalCost"></div>

        <h2 class="section">INCLUSIONS</h2>
        <div class="info-list" id="inclusions"></div>

        <h2 class="section">EXCLUSIONS</h2>
        <div class="info-list" id="exclusions"></div>

        <h2 class="section" id="noteHeader" style="display:none;">NOTE</h2>
        <div class="info-list" id="noteContent" style="display:none;"></div>
    </div>

    <div class="btn-group navbar-print-hide">
        <button class="btn" id="downloadBtn"><i class="fa-solid fa-file-pdf"></i> Download PDF</button>
        <button class="btn" id="shareBtn"><i class="fa-solid fa-share-nodes"></i> Share</button>
    </div>

    <script>
        // Mobile menu toggle logic
        document.getElementById('mobileBtn').addEventListener('click', () => {
            document.getElementById('mobileMenu').classList.toggle('hidden');
        });

        // Original script logic
        const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSKWpvBUstFi-xtd__NDN3MqnMBb04fzGfAb9Ce27ao0gMGejfXqCp9V_Dh4G_Z8ungzPf4MHsy0hkx/pub?output=csv";
        const proxyUrl = "https://api.allorigins.win/raw?url=" + encodeURIComponent(sheetUrl);
        const params = new URLSearchParams(window.location.search);
        const packageName = params.get("package");
        let currentPkg = null;

        Papa.parse(proxyUrl, { download:true, header:true, complete:function(results){
            const allData = results.data;
            currentPkg = allData.find(r => r['Package Name'] === packageName);

            if(!currentPkg){ document.getElementById("preview").innerHTML = "<p class='text-center py-5'>Package not found. Please go back to the packages page.</p>"; return; }

            if(currentPkg["Logo"]){ document.getElementById("logoBox").innerHTML = `<img src="${currentPkg["Logo"]}" alt="Logo">`; }
            document.getElementById("packageTitle").innerText = currentPkg["Package Name"] + " â€“ " + currentPkg["Duration"];

            // Itinerary
            if(currentPkg["Itinerary"]){
                const days = currentPkg["Itinerary"].split(/Day\s*\d+:/i);
                let matches = currentPkg["Itinerary"].match(/Day\s*\d+:/gi) || [];
                let formatted = "";
                for(let i=1;i<days.length;i++){
                    let lines = days[i].trim().split("\n").filter(l=>l);
                    formatted += `<div class="day"><strong>${matches[i-1]} ${lines[0]||""}</strong><ul>` 
                                    + lines.map(l=>`<li>${l}</li>`).join("") 
                                    + "</ul></div>";
                }
                document.getElementById("itinerary").innerHTML = formatted;
            }

            // Hotels
            if(currentPkg["Hotels"]){
                let rows = currentPkg["Hotels"].split("\n").map(h=>{
                    let [city,hotel,nights,meals] = h.split("|");
                    return `<tr><td>${city||""}</td><td>${hotel||""}</td><td>${nights||""}</td><td>${meals||""}</td></tr>`;
                }).join("");
                document.getElementById("hotelTable").innerHTML = rows;
            }

            document.getElementById("totalCost").innerText = currentPkg["Price"]||"";

            // Inclusions
            document.getElementById("inclusions").innerHTML = currentPkg["Inclusions"] 
                ? "<ul>" + currentPkg["Inclusions"].split("\n").map(i=>`<li>${i}</li>`).join("") + "</ul>" 
                : "Not specified.";

            // Exclusions
            document.getElementById("exclusions").innerHTML = currentPkg["Exclusions"] 
                ? "<ul>" + currentPkg["Exclusions"].split("\n").map(i=>`<li>${i}</li>`).join("") + "</ul>" 
                : "Not specified.";

            // Note
            if(currentPkg["Note"] && currentPkg["Note"].trim() !== ""){
                document.getElementById("noteHeader").style.display = "block";
                document.getElementById("noteContent").style.display = "block";
                document.getElementById("noteContent").innerHTML = "<ul>" 
                    + currentPkg["Note"].split("\n").map(i=>`<li>${i}</li>`).join("") 
                    + "</ul>";
            } else {
                document.getElementById("noteHeader").style.display = "none";
                document.getElementById("noteContent").style.display = "none";
            }

        }});

        // Print (native) for PDF
        document.getElementById("downloadBtn").addEventListener("click", () => {
            window.print();
        });

        // Share button
        document.getElementById("shareBtn").addEventListener("click", () => {
            if (navigator.clipboard) {
                navigator.clipboard.writeText(window.location.href).then(()=>{ alert("Share link copied!"); })
                .catch(()=>{ alert("Failed to copy link. Please copy manually."); });
            } else {
                alert("Your browser does not support clipboard API. Please copy the URL manually.");
            }
        });
    </script>

</body>
</html>